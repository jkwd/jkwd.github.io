<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Databricks DE Associate Notes | John Koh </title> <meta name="author" content="John Koh"> <meta name="description" content="Notes for Databricks DE Associate Certification"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?6b8f493672acdc2dec9dd24ea9f5b855" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/jk.ico?17701e4c193bcbbeb8562ecc8617eb58"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jkwd.github.io/blog/2025/databricks-data-engineer-associate/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">John</span> Koh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">About </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Databricks DE Associate Notes</h1> <p class="post-meta"> Created on January 10, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a> Â  Â· Â  <a href="/blog/tag/data-engineering"> <i class="fa-solid fa-hashtag fa-sm"></i> data_engineering</a> Â  <a href="/blog/tag/databricks"> <i class="fa-solid fa-hashtag fa-sm"></i> databricks</a> Â  Â· Â  <a href="/blog/category/learning"> <i class="fa-solid fa-tag fa-sm"></i> learning</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"><a href="#auto-generate-the-column-when-create-table">Auto generate the column when create table</a></li> <li class="toc-entry toc-h1"><a href="#auto-loader-streaming-vs-copy-into">Auto Loader (Streaming) vs Copy Into</a></li> <li class="toc-entry toc-h1"><a href="#control-and-data-plane">Control and Data Plane</a></li> <li class="toc-entry toc-h1"> <a href="#time-travel">Time Travel</a> <ul> <li class="toc-entry toc-h2"><a href="#by-timestamp">By Timestamp</a></li> <li class="toc-entry toc-h2"><a href="#by-version-number">By Version Number</a></li> <li class="toc-entry toc-h2"><a href="#restore">Restore</a></li> </ul> </li> <li class="toc-entry toc-h1"><a href="#temporary-view">Temporary View</a></li> <li class="toc-entry toc-h1"><a href="#udf">UDF</a></li> <li class="toc-entry toc-h1"> <a href="#permission">Permission</a> <ul> <li class="toc-entry toc-h2"><a href="#usage-privilege">Usage Privilege</a></li> <li class="toc-entry toc-h2"><a href="#ownership">Ownership</a></li> </ul> </li> <li class="toc-entry toc-h1"><a href="#query-external-files">Query external files</a></li> <li class="toc-entry toc-h1"><a href="#drop-database-and-all-its-tables">Drop database and all its tables</a></li> <li class="toc-entry toc-h1"><a href="#create-jdbc-table">Create JDBC table</a></li> <li class="toc-entry toc-h1"> <a href="#copy-table">Copy table</a> <ul> <li class="toc-entry toc-h2"><a href="#shallow-clone">Shallow Clone</a></li> <li class="toc-entry toc-h2"><a href="#deep-clone">Deep Clone</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#managedexternal-table">Managed/External table</a> <ul> <li class="toc-entry toc-h2"><a href="#managed">Managed</a></li> <li class="toc-entry toc-h2"><a href="#external">External</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#structured-streaming">Structured Streaming</a> <ul> <li class="toc-entry toc-h2"><a href="#limitations">Limitations</a></li> <li class="toc-entry toc-h2"><a href="#properties-of-structured-streaming">Properties of structured streaming</a></li> <li class="toc-entry toc-h2"><a href="#output-modes">Output modes</a></li> <li class="toc-entry toc-h2"><a href="#active-streams">Active streams</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#delta-live-tables">Delta Live Tables</a> <ul> <li class="toc-entry toc-h2"><a href="#development">Development</a></li> <li class="toc-entry toc-h2"><a href="#production">Production</a></li> <li class="toc-entry toc-h2"><a href="#dlt-expectations">DLT Expectations</a></li> </ul> </li> <li class="toc-entry toc-h1"><a href="#alerts">Alerts</a></li> <li class="toc-entry toc-h1"><a href="#unity-catalog">Unity catalog</a></li> <li class="toc-entry toc-h1"><a href="#running-notebook">Running notebook</a></li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="auto-generate-the-column-when-create-table">Auto generate the column when create table</h1> <ul> <li>GENERATED ALWAYS AS (CAST(orderTime as DATE))</li> </ul> <h1 id="auto-loader-streaming-vs-copy-into">Auto Loader (Streaming) vs Copy Into</h1> <p><code class="language-plaintext highlighter-rouge">Identified via cloudFiles in streaming</code></p> <ul> <li>Auto loader supports both directory listing and file notification but COPY INTO only supports directory listing. <ul> <li>Directory listing - List Directory and maintain the state in RocksDB, supports incremental file listing</li> <li>File notification - Uses a trigger+queue to store the file notification which can be later used to retrieve the file, unlike Directory listing File notification can scale up to millions of files per day.</li> </ul> </li> <li>Schema location is used to store schema inferred by AUTO LOADER <ul> <li>To allow AUTO LOADER to run faster next time</li> </ul> </li> <li>Use Auto Loader when <ul> <li>having large number of files</li> <li>schema evolve frequently</li> </ul> </li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2023-06-01-databricks-data-engineer-associate/1-480.webp 480w,/assets/img/2023-06-01-databricks-data-engineer-associate/1-800.webp 800w,/assets/img/2023-06-01-databricks-data-engineer-associate/1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2023-06-01-databricks-data-engineer-associate/1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <ul> <li>COPY INTO keeps track of files that were successfully loaded into the table, the next time when the COPY INTO runs it skips them.</li> </ul> <h1 id="control-and-data-plane">Control and Data Plane</h1> <ul> <li>Control <ul> <li>Stored in Databricks Cloud Account</li> <li>Notebook commands and many other workspace configurations are stored in the control plane and encrypted at rest</li> </ul> </li> <li>Data <ul> <li>Stored in Customer Cloud Account</li> <li>For most Databricks computation, the compute resources are in your AWS account in what is called theÂ <em>Classic data plane</em> </li> </ul> </li> <li>Both <ul> <li>Interactive Notebook</li> </ul> </li> </ul> <h1 id="time-travel">Time Travel</h1> <h2 id="by-timestamp">By Timestamp</h2> <p><code class="language-plaintext highlighter-rouge">select * from table TIMESTAMP AS OF "2022-01-01"</code></p> <h2 id="by-version-number">By Version Number</h2> <p><code class="language-plaintext highlighter-rouge">select * from table VERSION AS OF 2</code></p> <p><code class="language-plaintext highlighter-rouge">select * from table@2</code></p> <p><code class="language-plaintext highlighter-rouge">select * from delta.'/path/to/table@2</code></p> <h2 id="restore">Restore</h2> <p><code class="language-plaintext highlighter-rouge">RESTORE table TO VERSION as of 2</code></p> <h1 id="temporary-view">Temporary View</h1> <ul> <li>Session scoped temp view <ul> <li>only available with a spark session, so another notebook in the same cluster can not access it</li> <li>if a notebook is detached and reattached local temporary view is lost</li> </ul> </li> <li>Global temp view <ul> <li>available to all the notebooks in the cluster</li> <li>can still be accessed when notebook is detached and attached</li> <li>if a cluster restarts global temporary view is lost</li> </ul> </li> </ul> <h1 id="udf">UDF</h1> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">FUNCTION</span> <span class="n">fn</span><span class="p">(...)</span>
<span class="k">RETURNS</span> <span class="nb">DOUBLE</span>
<span class="k">RETURN</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span>
</code></pre></div></div> <h1 id="permission">Permission</h1> <p><code class="language-plaintext highlighter-rouge">GOT</code>: GRANT <action> ON TABLE &lt;table&gt; TO &lt;user/group email&gt;</action></p> <p>To give all permission, use <code class="language-plaintext highlighter-rouge">ALL PRIVILEGES</code></p> <blockquote> <p>ðŸ’¡ Insert, Update, Delete are combined to <code class="language-plaintext highlighter-rouge">Modify</code></p> </blockquote> <h2 id="usage-privilege">Usage Privilege</h2> <p>To perform an action on a schema object in the Hive metastore, a user must have theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â privilege on that schema in addition to the privilege to perform that action. Any one of the following satisfies theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â requirement:</p> <ul> <li>Be a workspace admin</li> <li>Have theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â privilege on the schema or be in a group that has theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â privilege on the schema</li> <li>Have theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â privilege on theÂ <code class="language-plaintext highlighter-rouge">CATALOG</code>Â or be in a group that has theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â privilege</li> <li>Be the owner of the schema or be in a group that owns the schema</li> </ul> <p>Even the owner of an object inside a schema must have theÂ <code class="language-plaintext highlighter-rouge">USAGE</code>Â privilege in order to use it.</p> <h2 id="ownership">Ownership</h2> <ul> <li>Ownership determines whether or not you can grant privileges on derived objects to other users, since Steve is not the owner of the underlying sales table, he can not grant access to the table or data in the table indirectly</li> <li>A user who creates the object becomes its owner, does not matter who is the owner of the parent object</li> </ul> <h1 id="query-external-files">Query external files</h1> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">format</span><span class="p">.</span><span class="nv">`/Location`</span>
</code></pre></div></div> <p>format - CSV, JSON, PARQUET, TEXT</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="k">table_name</span> <span class="p">(</span><span class="n">col_name1</span> <span class="n">col_typ1</span><span class="p">,..)</span>
<span class="k">USING</span> <span class="n">data_source</span>
<span class="k">OPTIONS</span> <span class="p">(</span><span class="k">key</span><span class="o">=</span><span class="err">â€™</span><span class="n">value</span><span class="err">â€™</span><span class="p">,</span> <span class="n">key2</span><span class="o">=</span><span class="n">vla2</span><span class="p">)</span>
<span class="k">LOCATION</span> <span class="o">=</span> <span class="err">â€œ</span><span class="o">/</span><span class="k">location</span><span class="err">â€œ</span>
</code></pre></div></div> <p>^data_source = CSV, etc</p> <h1 id="drop-database-and-all-its-tables">Drop database and all its tables</h1> <p><code class="language-plaintext highlighter-rouge">DROP DATABASE customers CASCADE</code></p> <h1 id="create-jdbc-table">Create JDBC table</h1> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users_jdbc</span>
<span class="k">USING</span> <span class="n">org</span><span class="p">.</span><span class="n">apache</span><span class="p">.</span><span class="n">spark</span><span class="p">.</span><span class="k">sql</span><span class="p">.</span><span class="n">jdbc</span>
<span class="k">OPTIONS</span> <span class="p">(</span>
    <span class="n">url</span> <span class="o">=</span> <span class="nv">"jdbc:sqlite:/sqmple_db"</span><span class="p">,</span>
    <span class="n">dbtable</span> <span class="o">=</span> <span class="nv">"users"</span>
<span class="p">)</span>
</code></pre></div></div> <h1 id="copy-table">Copy table</h1> <h2 id="shallow-clone">Shallow Clone</h2> <ul> <li>Shallow clones just copy the Delta transaction logs, meaning that the data doesnâ€™t move so it can be very quick</li> </ul> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="p">{</span><span class="n">new_table_name</span><span class="p">}</span>
<span class="n">SHALLOW</span> <span class="n">CLONE</span> <span class="p">{</span><span class="n">source_table_name</span><span class="p">}</span><span class="o">|</span><span class="p">[</span><span class="k">LOCATION</span> <span class="n">path</span><span class="p">]</span>
</code></pre></div></div> <h2 id="deep-clone">Deep Clone</h2> <ul> <li>It copies all of the data and transaction logs this can take a long time based on the size of the table</li> </ul> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">TABLE</span> <span class="p">{</span><span class="n">new_table_name</span><span class="p">}</span>
<span class="n">DEEP</span> <span class="n">CLONE</span> <span class="p">{</span><span class="n">source_table_name</span><span class="p">}</span><span class="o">|</span><span class="p">[</span><span class="k">LOCATION</span> <span class="n">path</span><span class="p">]</span>
</code></pre></div></div> <h1 id="managedexternal-table">Managed/External table</h1> <h2 id="managed">Managed</h2> <p>A drop command will drop everything from metastore and storage.</p> <h2 id="external">External</h2> <p>A drop command will only drop data but not metadata and logs</p> <h1 id="structured-streaming">Structured Streaming</h1> <h2 id="limitations">Limitations</h2> <ul> <li>Multiple streaming aggregations (i.e. a chain of aggregations on a streaming DF) are not yet supported on streaming Datasets.</li> <li>Limit and take the first N rows are not supported on streaming Datasets.</li> <li>Distinct operations on streaming Datasets are not supported.</li> <li>Deduplication operation is not supported after aggregation on a streaming Datasets.</li> <li><code class="language-plaintext highlighter-rouge">Sorting operations are supported on streaming Datasets only after an aggregation and in Complete Output Mode.</code></li> </ul> <p><code class="language-plaintext highlighter-rouge">Note: Sorting without aggregation function is not supported.</code></p> <h2 id="properties-of-structured-streaming">Properties of structured streaming</h2> <ul> <li>Structured Streaming uses <code class="language-plaintext highlighter-rouge">checkpointing</code> and <code class="language-plaintext highlighter-rouge">write-ahead logs</code> to record the offset range of data being processed during each trigger interval.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Once
</span><span class="n">spark</span><span class="p">.</span><span class="n">readStream</span>
  <span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">delta</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="sh">"</span><span class="s">events_log</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">groupBy</span><span class="p">(</span><span class="sh">"</span><span class="s">customerId</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">count</span><span class="p">()</span>
  <span class="p">.</span><span class="n">writeStream</span>
  <span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">delta</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">outputMode</span><span class="p">(</span><span class="sh">"</span><span class="s">complete</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">option</span><span class="p">(</span><span class="sh">"</span><span class="s">checkpointLocation</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">/tmp/delta/eventsByCustomer/_checkpoints/</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">trigger</span><span class="p">(</span><span class="n">once</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="sh">"</span><span class="s">target_table</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># every 15mins
</span><span class="n">spark</span><span class="p">.</span><span class="n">readStream</span>
  <span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">delta</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="sh">"</span><span class="s">events_log</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">groupBy</span><span class="p">(</span><span class="sh">"</span><span class="s">customerId</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">count</span><span class="p">()</span>
  <span class="p">.</span><span class="n">writeStream</span>
  <span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">delta</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">outputMode</span><span class="p">(</span><span class="sh">"</span><span class="s">complete</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">option</span><span class="p">(</span><span class="sh">"</span><span class="s">checkpointLocation</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">/tmp/delta/eventsByCustomer/_checkpoints/</span><span class="sh">"</span><span class="p">)</span>
	<span class="p">.</span><span class="nf">trigger</span><span class="p">(</span><span class="n">processingTime</span> <span class="o">=</span> <span class="sh">"</span><span class="s">15 Minutes</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="sh">"</span><span class="s">target_table</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># Available now
</span><span class="n">spark</span><span class="p">.</span><span class="n">readStream</span>
  <span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">delta</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="sh">"</span><span class="s">events_log</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">groupBy</span><span class="p">(</span><span class="sh">"</span><span class="s">customerId</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">count</span><span class="p">()</span>
  <span class="p">.</span><span class="n">writeStream</span>
  <span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="sh">"</span><span class="s">delta</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">outputMode</span><span class="p">(</span><span class="sh">"</span><span class="s">complete</span><span class="sh">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">option</span><span class="p">(</span><span class="sh">"</span><span class="s">checkpointLocation</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">/tmp/delta/eventsByCustomer/_checkpoints/</span><span class="sh">"</span><span class="p">)</span>
	<span class="p">.</span><span class="nf">trigger</span><span class="p">(</span><span class="n">availableNow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  <span class="p">.</span><span class="nf">table</span><span class="p">(</span><span class="sh">"</span><span class="s">target_table</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <h2 id="output-modes">Output modes</h2> <ul> <li>Append</li> <li>Update</li> <li>Complete</li> </ul> <h2 id="active-streams">Active streams</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spark</span><span class="p">.</span><span class="n">streams</span><span class="p">.</span><span class="n">active</span><span class="p">:</span>
	<span class="n">s</span><span class="p">.</span><span class="nf">stop</span><span class="p">()</span>
</code></pre></div></div> <h1 id="delta-live-tables">Delta Live Tables</h1> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">create</span> <span class="k">or</span> <span class="k">replace</span> <span class="n">live</span> <span class="k">table</span> <span class="n">orders_valid</span>
<span class="p">(</span><span class="k">constraint</span> <span class="n">valid_timestamp</span> <span class="n">expect</span> <span class="p">(</span><span class="nb">timestamp</span> <span class="o">&gt;</span> <span class="nv">"2020-01-01"</span><span class="p">)</span> <span class="k">on</span> <span class="n">violation</span> <span class="k">drop</span> <span class="k">row</span><span class="p">)</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">live</span><span class="p">.</span><span class="n">orders_vw</span>
</code></pre></div></div> <ul> <li>DLT pipeline supports two modes Development and Production, you can switch between the two based on the stage of your development and deployment lifecycle.</li> </ul> <h2 id="development">Development</h2> <ul> <li>Reuses a cluster to avoid the overhead of restarts</li> <li>Disables pipeline retries so you can immediately detect and fix errors</li> </ul> <h2 id="production">Production</h2> <ul> <li>Restarts the cluster for specific recoverable errors, including memory leaks and stale credentials</li> <li>Retries execution in the event of specific errors, for example, a failure to start a cluster</li> </ul> <h2 id="dlt-expectations">DLT Expectations</h2> <ul> <li>CONSTRAINT valid_timestamp EXPECT (timestamp &gt; â€˜2020-01-01â€™) <ul> <li>Retain</li> <li>flag invalid in log</li> <li>pipeline continues</li> </ul> </li> <li>CONSTRAINT valid_timestamp EXPECT (timestamp &gt; â€˜2020-01-01â€™) ON VIOLATION DROP ROW <ul> <li>Drop</li> <li>flag invalid in log</li> <li>pipeline continues</li> </ul> </li> <li>CONSTRAINT valid_timestamp EXPECT (timestamp &gt; â€˜2020-01-01â€™) ON VIOLATION FAIL <ul> <li>job fail</li> </ul> </li> </ul> <p>Linking Notebook with DLT</p> <ul> <li>Single job can be used to set up both notebook and DLT pipeline, use two different tasks with linear dependency</li> </ul> <p>format - CSV, JSON, PARQUET, TEXT</p> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2023-06-01-databricks-data-engineer-associate/2-480.webp 480w,/assets/img/2023-06-01-databricks-data-engineer-associate/2-800.webp 800w,/assets/img/2023-06-01-databricks-data-engineer-associate/2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2023-06-01-databricks-data-engineer-associate/2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h1 id="alerts">Alerts</h1> <ul> <li>Alerts support custom template supports using variables to customize the default message</li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2023-06-01-databricks-data-engineer-associate/3-480.webp 480w,/assets/img/2023-06-01-databricks-data-engineer-associate/3-800.webp 800w,/assets/img/2023-06-01-databricks-data-engineer-associate/3-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2023-06-01-databricks-data-engineer-associate/3.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <ul> <li>Alerts support webhook</li> </ul> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2023-06-01-databricks-data-engineer-associate/4-480.webp 480w,/assets/img/2023-06-01-databricks-data-engineer-associate/4-800.webp 800w,/assets/img/2023-06-01-databricks-data-engineer-associate/4-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2023-06-01-databricks-data-engineer-associate/4.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h1 id="unity-catalog">Unity catalog</h1> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2023-06-01-databricks-data-engineer-associate/5-480.webp 480w,/assets/img/2023-06-01-databricks-data-engineer-associate/5-800.webp 800w,/assets/img/2023-06-01-databricks-data-engineer-associate/5-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2023-06-01-databricks-data-engineer-associate/5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h1 id="running-notebook">Running notebook</h1> <p><code class="language-plaintext highlighter-rouge">dbutils.notebook.run(" full notebook path ")</code></p> <p><code class="language-plaintext highlighter-rouge">run(path: String, timeout_seconds: int, arguments: Map): String</code></p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h1 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h1> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/chess-de-project/">Chess DE Project</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/full-vs-incremental-load/">Full vs incremental load</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/oltp-vs-olap/">Benchmarking OLTP vs OLAP</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/github-actions/">Github Actions Tutorial</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/terraform-notes/">Terraform Tutorial</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> Â© Copyright 2025 John Koh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-57NGLGRVZL"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-57NGLGRVZL');
  </script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>