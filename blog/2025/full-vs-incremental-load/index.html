<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Full vs incremental load | John Koh </title> <meta name="author" content="John Koh"> <meta name="description" content="Explaining pros and cons of Full Load vs Incremental Load"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?6b8f493672acdc2dec9dd24ea9f5b855" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/jk.ico?17701e4c193bcbbeb8562ecc8617eb58"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jkwd.github.io/blog/2025/full-vs-incremental-load/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">John</span> Koh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">About </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Full vs incremental load</h1> <p class="post-meta"> Created on March 20, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/data-engineering"> <i class="fa-solid fa-hashtag fa-sm"></i> data_engineering</a>   <a href="/blog/tag/ingestion"> <i class="fa-solid fa-hashtag fa-sm"></i> ingestion</a>   ·   <a href="/blog/category/learning"> <i class="fa-solid fa-tag fa-sm"></i> learning</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"><a href="#introduction">Introduction</a></li> <li class="toc-entry toc-h1"> <a href="#ingestion">Ingestion</a> <ul> <li class="toc-entry toc-h2"> <a href="#full-load">Full load</a> <ul> <li class="toc-entry toc-h3"><a href="#pros">Pros</a></li> <li class="toc-entry toc-h3"><a href="#cons">Cons</a></li> </ul> </li> <li class="toc-entry toc-h2"> <a href="#incremental-load">Incremental Load</a> <ul> <li class="toc-entry toc-h3"><a href="#pros-1">Pros</a></li> <li class="toc-entry toc-h3"><a href="#cons-1">Cons</a></li> <li class="toc-entry toc-h3"> <a href="#methods-of-incremental-load">Methods of Incremental Load</a> <ul> <li class="toc-entry toc-h4"><a href="#timestamp-based-approach">Timestamp based approach</a></li> <li class="toc-entry toc-h4"><a href="#log-basedchange-data-capture-cdc-approach">Log based/Change data capture (CDC) approach</a></li> </ul> </li> </ul> </li> <li class="toc-entry toc-h2"><a href="#summary-table">Summary table</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="introduction">Introduction</h1> <p>In this <a href="/blog/2025/oltp-vs-olap/">article</a>, we explored Online Transaction Processing (OLTP) database vs an Online analytical processing (OLAP) database and their purposes. We covered the idea that OLTP are meant for daily operations such as e-commerce transactions, where there is large volume of single transactions happening at any point in time, while OLAP are meant for analytical use cases.</p> <p>Although we can technically still perform business-oriented queries on OLTP databases accepting the fact that it’s slower, its also not recommended as we do not want to overload the database and risk having an outage. The OLTP database is what powers the webapp/app UI that the end users interface with and bringing the OLTP database down will be detrimental to the company.</p> <p>Therefore to perform business-oriented queries, we would take the data in the OLTP databases and ingest/load them into an offline area. This can be in the form of a datalake such as S3 or into a OLAP database such as a data warehouse where there is no additional stress on the operational databases during heavy queries.</p> <h1 id="ingestion">Ingestion</h1> <p>There are 2 main type of data ingestion strategy, Full Load and Incremental Load. Each of them have their set of pros and cons and we will discuss about them in detail below. Another key point is that ingestions generally involves a source (e.g. API, database, filesystem) and a destination (e.g. database, filesystem).</p> <h2 id="full-load">Full load</h2> <p>In a full load strategy, as the name suggests, the entire source data is read and loaded to the destination. If the destination already contains existing data, it will be deleted and replaced with the latest records that are coming in.</p> <p>This method is usually used if the data we are processing is small enough, or during the initial setup and followed by an incremental load subsequently (more details later), or to refresh the data warehouse to the latest data. Full load can be time consuming as we are reading the entire data from the source. This also incur a sudden burst of stress for the source system especially if the data we are ingesting is large.</p> <p>A Full Load should be done preferably when we know the traffic to the app and transaction to the source database is low so to avoid spike in resource consumption on the system.</p> <h3 id="pros">Pros</h3> <ol> <li>Complexity: Easy to setup a full load from the source system to the destination system. A naive way to think is a CTRL-C + CTRL V (overwrite existing data)</li> <li>Data consistency: Data in the destination is consistent with the source system</li> </ol> <h3 id="cons">Cons</h3> <ol> <li>Ingestion Speed: Slow for large dataset as it requires a full scan on the source data</li> <li>Stress on source system: Resource consumption (e.g. CPU) can spike during a full load especially if the data is large and may impact other applications that are running.</li> </ol> <h2 id="incremental-load">Incremental Load</h2> <p>In an incremental load strategy, only the updated/newest data from the source system are loaded to the destination system. This results in lesser data being transferred between them which improves speed and reduces stress.</p> <p>This method is useful for large data in the source system where doing a full load is not ideal, or if we wish to process data in smaller time intervals (e.g. hourly as we only need to process the new/updated data from the past hour).</p> <p>Incremental Load can also be otherwise known as Change Data Capture (CDC) or Delta Load.</p> <h3 id="pros-1">Pros</h3> <ol> <li>Ingestion Speed: Faster than Full Load since we are only loading new/updated data.</li> <li>Stress on source system: Less stress as we are only getting the new/updated data instead of the whole data table everytime.</li> <li>Frequency of ingestion: Allows for flexibility of more frequent ingestion due to the above 2 reasons.</li> <li>Scalability: Useful for large datasets.</li> </ol> <h3 id="cons-1">Cons</h3> <ol> <li>Complexity: Harder to implement. Requires additional columns (e.g. timestamp column), or other change data capture mechanism to reconcile the data. This requires more technical expertise.</li> <li>Data consistency: Managing data consistency between the source and destination system is more complex as well. This can come in the form of schema evolution where a column changes data type, or missing data.</li> </ol> <h3 id="methods-of-incremental-load">Methods of Incremental Load</h3> <h4 id="timestamp-based-approach">Timestamp based approach</h4> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2025-03-20-full-vs-incremental-load/1-480.webp 480w,/assets/img/2025-03-20-full-vs-incremental-load/1-800.webp 800w,/assets/img/2025-03-20-full-vs-incremental-load/1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2025-03-20-full-vs-incremental-load/1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>In a timestamp based approach, the source table will need to have a timestamp column to reference, usually an <code class="language-plaintext highlighter-rouge">updated_at</code> column. Whenever a new record is added or an existing record (see Green) is updated in the source database, the <code class="language-plaintext highlighter-rouge">updated_at</code> column will reflect the latest timestamp. This allows us to keep track on the records that are updated after the last incremental load.</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="n">source_table</span>
<span class="k">where</span> <span class="n">updated_at</span> <span class="o">&gt;</span> <span class="n">last_ingested_time</span>
</code></pre></div></div> <p>We can keep track of the last ingested time and identify new/updated records past the time.</p> <p>If you want to indicate if a row is an INSERT or and UPDATE, then you may need to modify the setup by changing the query or adding new columns such as <code class="language-plaintext highlighter-rouge">created_at</code>.</p> <p>In this approach, it’ll be difficult to identify records that is deleted (see Red) in the source system unless we do some comparison between the source and destination tables to identify primary keys that do not exist in the source. This is what we call a soft delete approach where we can mark the record in the target table with an <code class="language-plaintext highlighter-rouge">is_deleted</code> flag.</p> <h4 id="log-basedchange-data-capture-cdc-approach">Log based/Change data capture (CDC) approach</h4> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2025-03-20-full-vs-incremental-load/2-480.webp 480w,/assets/img/2025-03-20-full-vs-incremental-load/2-800.webp 800w,/assets/img/2025-03-20-full-vs-incremental-load/2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2025-03-20-full-vs-incremental-load/2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>This method is applicable to source databases such as Postgres which contains transaction logs. These transaction logs store all events that allows the databse to be recovered in the event of a crash. We can utilise this logs to capture the transactions (e.g. insert/update/delete) and propagate it to the destination system. The data changes are captured in real time by connecting a tool to capture the data changes. This method will not require any scanning of the source database. However the additional complexity may come from the additional tool and configurations to the database for this to work.</p> <h2 id="summary-table">Summary table</h2> <table> <thead> <tr> <th> </th> <th>Full Load</th> <th>Incremental Load</th> </tr> </thead> <tbody> <tr> <td>Data Volume</td> <td>Entire dataset overwritten each time</td> <td>Only changed data needs to be processed (insert, update, delete)</td> </tr> <tr> <td>Frequency</td> <td>Less frequent</td> <td>More frequent</td> </tr> <tr> <td>Resource Usage</td> <td>Higher</td> <td>Lower</td> </tr> <tr> <td>Latency/Speed</td> <td>Slower</td> <td>Faster</td> </tr> <tr> <td>Complexity</td> <td>Simpler</td> <td>Complex</td> </tr> <tr> <td>Data consistency</td> <td>Consistent since its an overwrite</td> <td>Requries reconciliation via some logic and risk being inconsistent</td> </tr> </tbody> </table> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h1 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h1> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/chess-de-project/">Chess DE Project</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/oltp-vs-olap/">Benchmarking OLTP vs OLAP</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/github-actions/">Github Actions Tutorial</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/terraform-notes/">Terraform Tutorial</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/docker-notes/">Docker Tutorial</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 John Koh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-57NGLGRVZL"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-57NGLGRVZL');
  </script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>