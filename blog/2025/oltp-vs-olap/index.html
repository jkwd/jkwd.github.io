<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Benchmarking OLTP vs OLAP | John Koh </title> <meta name="author" content="John Koh"> <meta name="description" content="Simple experiment on OLTP and OLAP databases using TPC-H dataset"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?6b8f493672acdc2dec9dd24ea9f5b855" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/jk.ico?17701e4c193bcbbeb8562ecc8617eb58"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jkwd.github.io/blog/2025/oltp-vs-olap/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">John</span> Koh </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"> </a> </li> <li class="nav-item active"> <a class="nav-link" href="/index.html">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">About </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Benchmarking OLTP vs OLAP</h1> <p class="post-meta"> Created on February 21, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/data-engineering"> <i class="fa-solid fa-hashtag fa-sm"></i> data_engineering</a>   ·   <a href="/blog/category/project"> <i class="fa-solid fa-tag fa-sm"></i> project</a> </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"><a href="#setup">Setup</a></li> <li class="toc-entry toc-h1"><a href="#data-source">Data Source</a></li> <li class="toc-entry toc-h1"><a href="#experiment">Experiment</a></li> <li class="toc-entry toc-h1"><a href="#hypothesis">Hypothesis</a></li> <li class="toc-entry toc-h1"> <a href="#row-vs-column-oriented-storage">Row vs Column oriented Storage</a> <ul> <li class="toc-entry toc-h2"><a href="#row-oriented-storage">Row oriented storage</a></li> <li class="toc-entry toc-h2"><a href="#column-oriented-storage">Column oriented storage</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#result">Result</a> <ul> <li class="toc-entry toc-h2"><a href="#query-performance">Query performance</a></li> <li class="toc-entry toc-h2"><a href="#insert-performance">INSERT performance</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="setup">Setup</h1> <ol> <li>git clone the <a href="https://github.com/jkwd/oltp_vs_olap" rel="external nofollow noopener" target="_blank">repo</a> </li> <li>Install <a href="https://www.docker.com/get-started/" rel="external nofollow noopener" target="_blank">Docker</a> </li> <li>Check if docker compose comes installed with Docker by running <code class="language-plaintext highlighter-rouge">docker compose version</code> </li> <li>Install <a href="https://docs.docker.com/compose/install/" rel="external nofollow noopener" target="_blank">docker compose</a> </li> <li>Run the docker componse</li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/jkwd/oltp_vs_olap.git
cd oltp_vs_olap
docker compose version
docker compose up
</code></pre></div></div> <h1 id="data-source">Data Source</h1> <p>We are using the <a href="https://www.tpc.org/tpch/" rel="external nofollow noopener" target="_blank">TPC-H</a> data which is a decision support benchmark. It consists of a suite of business-oriented ad hoc queries and concurrent data modifications.</p> <h1 id="experiment">Experiment</h1> <p>We are going to benchmark the performance of an Online Transaction Processing (OLTP) database vs an Online analytical processing (OLAP) database on business-oriented query performance as well as transactional performance:</p> <ol> <li>business-oriented ad hoc query by <a href="https://docs.starrocks.io/docs/benchmarking/TPC-H_Benchmarking/#5-query-sql-and-create-table-statements" rel="external nofollow noopener" target="_blank">TPC-H</a> </li> <li>INSERT N records</li> </ol> <p>The OLTP database we are using for the experiment is a Postgres database. The OLAP database we are using is DuckDB.</p> <h1 id="hypothesis">Hypothesis</h1> <p>The hypothesis is that the OLTP database will perform better for transactional operations such as INSERT/UPDATE/DELETE while the OLAP database will perform better for the business-oriented ad hoc query.</p> <h1 id="row-vs-column-oriented-storage">Row vs Column oriented Storage</h1> <h2 id="row-oriented-storage">Row oriented storage</h2> <p>In a row-oriented storage, each row in a table is stored sequentially on the disk.</p> <table> <thead> <tr> <th>id</th> <th>Name</th> <th>Country</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Alice</td> <td>USA</td> </tr> <tr> <td>2</td> <td>Bob</td> <td>Germany</td> </tr> <tr> <td>3</td> <td>Charlie</td> <td>Australia</td> </tr> <tr> <td>4</td> <td>David</td> <td>Japan</td> </tr> </tbody> </table> <p>Given the example table above, a row oriented storage will be stored as:</p> <p><code class="language-plaintext highlighter-rouge">1 Alice USA | 2 Bob Germany | 3 Charlie Australia | 4 David Japan</code></p> <p>Each <code class="language-plaintext highlighter-rouge">|</code> represents the separation of a block and each row in the table is stored within the block.</p> <p>This makes the row oriented storage good for transactional use cases, which mainly focuses on INSERT/READ/UPDATE/DELETE of a single record, where if you need to update Bob’s Country from Germany to Italy, you can look for the specific block about Bob and update the value. This can be achieved by creating an index of the address of each block which then allows us to directly access the block that is needed.</p> <p>However, analytics queries will be poor as the column we need will be spread across the blocks. E.g. If we want to know the number of people in each country, we technically only need the <code class="language-plaintext highlighter-rouge">Country</code> column to count. This results in a full table scan just to get the results we want.</p> <h2 id="column-oriented-storage">Column oriented storage</h2> <p>In a column-oriented storage, each row in a table is stored sequentially on the disk.</p> <table> <thead> <tr> <th>id</th> <th>Name</th> <th>Country</th> </tr> </thead> <tbody> <tr> <td>1</td> <td>Alice</td> <td>USA</td> </tr> <tr> <td>2</td> <td>Bob</td> <td>Germany</td> </tr> <tr> <td>3</td> <td>Charlie</td> <td>Australia</td> </tr> <tr> <td>4</td> <td>David</td> <td>Japan</td> </tr> </tbody> </table> <p>Given the example table above, a column oriented storage will be stored as:</p> <p><code class="language-plaintext highlighter-rouge">1 2 3 4 | Alice Bob Charlie David | USA Germany Australia Japan</code></p> <p>This makes an column oriented storage good for analytical queries. Going back to the previous example on wanting to know the number of people in each country, we just need to read 1 block of data which is the <code class="language-plaintext highlighter-rouge">Country</code> block and do our counting from there. Much lesser data is scanned and returned for the query.</p> <p>On the other hand, column oriented storage is poor for transactional processing which usually does an operation on 1 row. For example, if you wanted to add a row of data, each value from the new row has to be added to the correct block of the existing database. This requires accessing all the blocks. Column oriented storage will prefer doing operations in bulk (e.g. bulk insert/update).</p> <h1 id="result">Result</h1> <h2 id="query-performance">Query performance</h2> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2025-02-21-oltp-vs-olap/1-480.webp 480w,/assets/img/2025-02-21-oltp-vs-olap/1-800.webp 800w,/assets/img/2025-02-21-oltp-vs-olap/1-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2025-02-21-oltp-vs-olap/1.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>DuckDB executed all the queries in less than a second. Postgres on the other hand took at least 3 seconds for the query execution to complete. In fact 1 of the query took longer than 50 seconds!</p> <h2 id="insert-performance">INSERT performance</h2> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/2025-02-21-oltp-vs-olap/2-480.webp 480w,/assets/img/2025-02-21-oltp-vs-olap/2-800.webp 800w,/assets/img/2025-02-21-oltp-vs-olap/2-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/2025-02-21-oltp-vs-olap/2.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Postgres is about 4X faster when inserting records as compared to DuckDB.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h1 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h1> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/chess-de-project/">Chess DE Project</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/full-vs-incremental-load/">Full vs incremental load</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/github-actions/">Github Actions Tutorial</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/terraform-notes/">Terraform Tutorial</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2025/docker-notes/">Docker Tutorial</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 John Koh. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-57NGLGRVZL"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-57NGLGRVZL');
  </script> <script defer src="/assets/js/google-analytics-setup.js?12374742c4b1801ba82226e617af7e2d"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>